<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Approval Form Editor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7eb 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #1a2530 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            padding: 25px;
            height: fit-content;
        }
        
        .panel-title {
            color: #2c3e50;
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #34495e;
            font-size: 1.05rem;
        }
        
        textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #bdc3c7;
            border-radius: 8px;
            resize: vertical;
            font-family: inherit;
            font-size: 15px;
            transition: all 0.3s;
            background: #f9fbfd;
        }
        
        textarea:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            background: white;
        }
        
        .small-textarea { min-height: 60px; }
        .medium-textarea { min-height: 90px; }
        .large-textarea { min-height: 130px; }
        .xlarge-textarea { min-height: 200px; }
        
        .section-title {
            font-weight: 700;
            margin: 30px 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
            color: #2c3e50;
            font-size: 1.3rem;
            position: relative;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 80px;
            height: 3px;
            background: #3498db;
        }
        
        .variation-section {
            margin-bottom: 25px;
            border: 1px solid #ecf0f1;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .variation-header {
            background: #3498db;
            color: white;
            padding: 14px 18px;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .variation-body {
            padding: 18px;
            background: #f8fafc;
        }
        
        .variation-row {
            display: flex;
            gap: 18px;
            margin-bottom: 15px;
        }
        
        .variation-col {
            flex: 1;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 14px 24px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .secondary-button {
            background: #95a5a6;
        }
        
        .secondary-button:hover {
            background: #7f8c8d;
        }
        
        .success-button {
            background: #27ae60;
        }
        
        .success-button:hover {
            background: #219955;
        }
        
        .warning-button {
            background: #f39c12;
        }
        
        .warning-button:hover {
            background: #e67e22;
        }
        
        .output-panel {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        #html-output {
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre;
            overflow-x: auto;
            background: #f8fafc;
            padding: 25px;
            border-radius: 8px;
            border: 1px solid #bdc3c7;
            flex-grow: 1;
            line-height: 1.5;
            font-size: 14px;
            min-height: 300px;
        }
        
        .output-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
        }
        
        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }
        
        .file-input-container input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-input-button {
            width: 100%;
            text-align: center;
            justify-content: center;
        }
        
        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            padding: 18px 24px;
            background: #27ae60;
            color: white;
            border-radius: 8px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            transform: translateX(120%);
            transition: transform 0.4s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 16px;
            font-weight: 500;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: #e74c3c;
        }
        
        .instructions {
            background: #e8f4fc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid #3498db;
        }
        
        .instructions h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-left: 25px;
        }
        
        .instructions li {
            margin-bottom: 12px;
            line-height: 1.6;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .tab {
            padding: 14px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: #95a5a6;
            transition: all 0.3s;
        }
        
        .tab.active {
            border-bottom: 3px solid #3498db;
            color: #2c3e50;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .field-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 768px) {
            .variation-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .button-group button {
                width: 100%;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                width: 100%;
                text-align: center;
            }
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-file-contract"></i> Technical Approval Form Editor</h1>
            <p>Create, edit, and export technical approval forms with robust import functionality</p>
        </header>
        
        <div class="main-content">
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-edit"></i> Form Editor</h2>
                
                <div class="instructions">
                    <h3><i class="fas fa-info-circle"></i> How to use this editor</h3>
                    <ul>
                        <li>Edit any field below - all text areas support multi-line input</li>
                        <li>Click <strong>Generate HTML</strong> to create your table code</li>
                        <li>Use <strong>Import HTML</strong> to load previously generated files</li>
                        <li>Copy or download your generated HTML for use in documents</li>
                    </ul>
                </div>
                
                <div class="tabs">
                    <div class="tab active" data-tab="form">Form Fields</div>
                    <div class="tab" data-tab="import">Import HTML</div>
                </div>
                
                <div class="tab-content active" id="form-tab">
                    <form id="approval-form">
                        <div class="section-title">Main Title</div>
                        <div class="form-group">
                            <label for="work-name">Technical Approval of Post Award variation</label>
                            <textarea id="main-title" class="medium-textarea">('Interim Deviation'/ 'Final Deviation'/ 'Final Deviation with Final Time Extension')</textarea>
                        </div>
                        
                        <div class="section-title">1. Details of Purchase Order (PO)</div>
                        <div class="field-group">
                            <div class="form-group">
                                <label for="work-name">(i) Name of Work</label>
                                <textarea id="work-name" class="medium-textarea">Short term service contract for On-Line Leak Sealing for Boiler & TG & Other Auxiliary Areas at BgTPS (3x250MW)</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="project-name">(ii) Name of Project</label>
                                <textarea id="project-name" class="medium-textarea">Bongaigaon Thermal Power Project</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="po-details">(iii) PO No. & date</label>
                                <textarea id="po-details" class="medium-textarea">4000354058 Dated: 24.02.2025</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="po-value">(iv) PO Value (Original Awarded)</label>
                                <textarea id="po-value" class="medium-textarea">INR 438,348.85</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="contractor">(v) Name of Agency/ Contractor</label>
                                <textarea id="contractor" class="medium-textarea">M/s NICCO ENGINEERING SERVICES LTD</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="start-date">(vi) Date of Start (Scheduled)</label>
                                <textarea id="start-date" class="medium-textarea">04.03.2025 - as per PO</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="completion-date">(vii) Date of completion (Scheduled/ Actual)</label>
                                <textarea id="completion-date" class="large-textarea">Schedule 03.06.2025 - as per PO
Actual 03.06.2025 (If Completed)</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="location">(viii) Location of processing of award</label>
                                <textarea id="location" class="medium-textarea">CPG-1/ CPG-2/ CPG-3/ SSC/ Site</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="tendering-mode">(ix) Mode of Tendering</label>
                                <textarea id="tendering-mode" class="medium-textarea">OT/ LT/ ST</textarea>
                            </div>
                        </div>
                        
                        <div class="section-title">2. Details of subsequent Amendment</div>
                        <div class="form-group">
                            <textarea id="amendment-details" class="large-textarea">(i)Interim Deviation PO Version 1
(ii)Time Extension PO Version 2</textarea>
                        </div>
                        
                        <div class="section-title">3. Type for TA</div>
                        <div class="form-group">
                            <textarea id="ta-type" class="large-textarea">Quantity Variation/ New Items/ Substitutes items/ Final Time Extension 

(Interim Deviation/ Final Deviation/ Final Deviation with Final Time Extension)</textarea>
                        </div>
                        
                        <div class="section-title">4. Relevant Contract provision w.r.t. Deviation</div>
                        <div class="form-group">
                            <textarea id="contract-provision" class="xlarge-textarea">(i) Deviation Limit - ........... (as per Clause No..... of GCC/ SCC/ PO) 

(ii) Reference of Restricted quantities in PO, if any 

(iii)Reference of provision w.r.t. 'Liquidated Damage for delay' - if proposal includes aspect of LD 

(iv) Any other relevant provisions [Ref. of PO/ GCC/ SCC etc.]</textarea>
                        </div>
                        
                        <div class="section-title">5. Reason/analysis of changes proposed Technical Proposal & recommendation</div>
                        <div class="form-group">
                            <textarea id="reason-analysis" class="xlarge-textarea">The PR for the Biennial Service Contract for On-Line Leak Sealing for Boiler, TG, and Other Auxiliary Areas at BgTPS (3x250MW) has been raised and is currently in the approval stage. A time extension is required to ensure uninterrupted emergency leak sealing work.

<b>Enclosures:</b>
(i) Vendor Concent Email in pdf Format
(ii) Rate analysis (as per provisions of Contract) for items deviating beyond deviation limit/ new items/ substituted items  
(iii) Delay analysis with calculation of LD amount - if proposal includes 'Final Time Extension'</textarea>
                        </div>
                        
                        <div class="section-title">6. Recommendation</div>
                        <div class="form-group">
                            <textarea id="recommendation" class="xlarge-textarea"><b>Proposed changes in Contract - Technical Approval</b>
*Proposed Contract value: ............
*Proposed Extension in Completion period (if applicable): 
  #Extension in Completion period Where delay is attributable to the Contractor: 
  #Extension in Completion period Where delay is not attributable to the Contractor: 
  #Proposed LD Amount:</textarea>
                        </div>
                        
                        <div class="section-title">7. Details of Gross cumulative variations</div>
                        <div class="variation-section">
                            <div class="variation-header">(i) Gross cumulative variation on composite basis till last Amendment, if any</div>
                            <div class="variation-body">
                                <div class="variation-row">
                                    <div class="variation-col">
                                        <label>w.r.t. within variation limit</label>
                                        <textarea class="small-textarea" id="variation-within-limit-i">0</textarea>
                                    </div>
                                    <div class="variation-col">
                                        <label>% variation on composite basis</label>
                                        <textarea class="small-textarea" id="variation-percent-i">0</textarea>
                                    </div>
                                </div>
                                <div class="variation-row">
                                    <div class="variation-col">
                                        <label>w.r.t. beyond variation/ new/ substituted items</label>
                                        <textarea class="small-textarea" id="variation-beyond-limit-i">0</textarea>
                                    </div>
                                    <div class="variation-col">
                                        <label>% variation on composite basis</label>
                                        <textarea class="small-textarea" id="variation-beyond-percent-i">0</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="variation-section">
                            <div class="variation-header">(ii) Gross variation on composite basis - in Present Proposal</div>
                            <div class="variation-body">
                                <div class="variation-row">
                                    <div class="variation-col">
                                        <label>w.r.t. within variation limit</label>
                                        <textarea class="small-textarea" id="variation-within-limit-ii">0</textarea>
                                    </div>
                                    <div class="variation-col">
                                        <label>% variation on composite basis</label>
                                        <textarea class="small-textarea" id="variation-percent-ii">0</textarea>
                                    </div>
                                </div>
                                <div class="variation-row">
                                    <div class="variation-col">
                                        <label>w.r.t. beyond variation/ new/ substituted items</label>
                                        <textarea class="small-textarea" id="variation-beyond-limit-ii">0</textarea>
                                    </div>
                                    <div class="variation-col">
                                        <label>% variation on composite basis</label>
                                        <textarea class="small-textarea" id="variation-beyond-percent-ii">0</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="variation-section">
                            <div class="variation-header">(iii) Gross cumulative variation on composite basis - including present Proposal</div>
                            <div class="variation-body">
                                <div class="variation-row">
                                    <div class="variation-col">
                                        <label>w.r.t. within variation limit</label>
                                        <textarea class="small-textarea" id="variation-within-limit-iii">0</textarea>
                                    </div>
                                    <div class="variation-col">
                                        <label>% variation on composite basis</label>
                                        <textarea class="small-textarea" id="variation-percent-iii">0</textarea>
                                    </div>
                                </div>
                                <div class="variation-row">
                                    <div class="variation-col">
                                        <label>w.r.t. beyond variation/ new/ substituted items</label>
                                        <textarea class="small-textarea" id="variation-beyond-limit-iii">0</textarea>
                                    </div>
                                    <div class="variation-col">
                                        <label>% variation on composite basis</label>
                                        <textarea class="small-textarea" id="variation-beyond-percent-iii">0</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="section-title">8. Approving authority for Technical Approval</div>
                        <div class="form-group">
                            <label>For items within the variation limit provided in the contract</label>
                            <textarea id="approving-within-limit" class="large-textarea">SM as per Sec. II, Clause 8.1 (a) of DOP 2023</textarea>
                        </div>
                        <div class="form-group">
                            <label>For items beyond the variation limit</label>
                            <textarea id="approving-beyond-limit" class="medium-textarea">NA</textarea>
                        </div>
                        
                        <div class="button-group">
                            <button type="button" onclick="generateUpdatedHtml()" class="success-button">
                                <i class="fas fa-code"></i> Generate HTML
                            </button>
                            <button type="button" class="secondary-button" onclick="resetForm()">
                                <i class="fas fa-redo"></i> Reset Form
                            </button>
                            <a href="../">
                                <button type="button" class="secondary-button">
                                    <i class="fas fa-home"></i> Home
                                </button>
                            </a>
                        </div>
                    </form>
                </div>
                
                <div class="tab-content" id="import-tab">
                    <div class="instructions">
                        <h3><i class="fas fa-file-import"></i> Import Existing HTML</h3>
                        <p>Upload a previously generated HTML file to load its content into the form for editing:</p>
                    </div>
                    
                    <div class="form-group">
                        <div class="file-input-container">
                            <button type="button" class="warning-button file-input-button">
                                <i class="fas fa-upload"></i> Select HTML File
                            </button>
                            <input type="file" id="import-file" accept=".html">
                        </div>
                        
                        <div id="file-info" style="margin-top: 20px; padding: 20px; background: #f8fafc; border-radius: 8px; display: none;">
                            <p><strong>Selected file:</strong> <span id="file-name" style="font-weight: 500;"></span></p>
                            <button type="button" class="success-button" onclick="importHtml()" style="margin-top: 15px;">
                                <i class="fas fa-file-import"></i> Import File
                            </button>
                        </div>
                        
                        <div class="button-group" style="margin-top: 30px;">
                            <button type="button" class="secondary-button" onclick="showFormTab()">
                                <i class="fas fa-arrow-left"></i> Back to Form
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel output-panel">
                <h2 class="panel-title"><i class="fas fa-file-code"></i> Generated Output</h2>
                <div id="output-container">
                    <textarea id="html-output" readonly>Your generated HTML will appear here...</textarea>
                </div>
                
                <div class="output-controls">
                    <div class="button-group">
                        <button onclick="copyToClipboard()" class="success-button">
                            <i class="fas fa-copy"></i> Copy to Clipboard
                        </button>
                        <button onclick="downloadHtml()" class="warning-button">
                            <i class="fas fa-download"></i> Download HTML
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i> <span id="notification-text">Copied to clipboard!</span>
    </div>
    
    <script>
        // Tab navigation
        function showImportTab() {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelector('.tab[data-tab="import"]').classList.add('active');
            document.getElementById('import-tab').classList.add('active');
        }
        
        function showFormTab() {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelector('.tab[data-tab="form"]').classList.add('active');
            document.getElementById('form-tab').classList.add('active');
        }
        
        // Tab click handlers
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.getAttribute('data-tab');
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(`${tabName}-tab`).classList.add('active');
            });
        });
        
        // File input handling
        document.getElementById('import-file').addEventListener('change', function(e) {
            if (this.files.length > 0) {
                const fileName = this.files[0].name;
                document.getElementById('file-name').textContent = fileName;
                document.getElementById('file-info').style.display = 'block';
            }
        });
        
        // Format text with line breaks converted to <br/> tags
        function formatText(text) {
            if (!text) return '';
            return text.split('\n').filter(line => line.trim() !== '').join('<br/>');
        }
        
        // Parse HTML content to extract text
        function parseHtmlContent(htmlContent) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;
            return tempDiv.textContent || tempDiv.innerText || '';
        }
        
        // Import HTML functionality
        function importHtml() {
            const fileInput = document.getElementById('import-file');
            if (fileInput.files.length === 0) {
                showNotification('Please select a file first!', 'error');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const htmlContent = e.target.result;
                    
                    // Create a temporary DOM element to parse the HTML
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(htmlContent, 'text/html');
                    
                    // Extract data from the table using the IDs we added
                    const fields = [
                        'main-title', 'work-name', 'project-name', 'po-details', 'po-value',
                        'contractor', 'start-date', 'completion-date', 'location', 'tendering-mode',
                        'amendment-details', 'ta-type', 'contract-provision', 'reason-analysis',
                        'recommendation', 'variation-within-limit-i', 'variation-percent-i',
                        'variation-beyond-limit-i', 'variation-beyond-percent-i',
                        'variation-within-limit-ii', 'variation-percent-ii', 'variation-beyond-limit-ii',
                        'variation-beyond-percent-ii', 'variation-within-limit-iii', 'variation-percent-iii',
                        'variation-beyond-limit-iii', 'variation-beyond-percent-iii',
                        'approving-within-limit', 'approving-beyond-limit'
                    ];
                    
                    fields.forEach(fieldId => {
                        const element = doc.getElementById(fieldId);
                        if (element) {
                            // Convert <br> tags to newlines
                            let content = element.innerHTML.replace(/<br\s*\/?>/gi, '\n');
                            // Remove any remaining HTML tags
                            content = content.replace(/<[^>]+>/g, '');
                            // Set the form field value
                            document.getElementById(fieldId).value = content;
                        }
                    });
                    
                    showNotification('Form successfully imported!', 'success');
                    showFormTab();
                    
                    // Clear file input
                    fileInput.value = '';
                    document.getElementById('file-info').style.display = 'none';
                    
                    // Generate the HTML to show in the output panel
                    generateUpdatedHtml();
                } catch (error) {
                    showNotification('Error importing file: ' + error.message, 'error');
                }
            };
            
            reader.onerror = function() {
                showNotification('Error reading file', 'error');
            };
            
            reader.readAsText(file);
        }
        
        // Generate HTML function with IDs added to table cells
        function generateUpdatedHtml() {
            const mainTitle = document.getElementById('main-title').value;
            const workName = document.getElementById('work-name').value;
            const projectName = document.getElementById('project-name').value;
            const poDetails = document.getElementById('po-details').value;
            const poValue = document.getElementById('po-value').value;
            const contractor = document.getElementById('contractor').value;
            const startDate = document.getElementById('start-date').value;
            const completionDate = document.getElementById('completion-date').value;
            const location = document.getElementById('location').value;
            const tenderingMode = document.getElementById('tendering-mode').value;
            const amendmentDetails = document.getElementById('amendment-details').value;
            const taType = document.getElementById('ta-type').value;
            const contractProvision = document.getElementById('contract-provision').value;
            const reasonAnalysis = document.getElementById('reason-analysis').value;
            const recommendation = document.getElementById('recommendation').value;
            const approvingWithinLimit = document.getElementById('approving-within-limit').value;
            const approvingBeyondLimit = document.getElementById('approving-beyond-limit').value;
            
            // Variation fields
            const variationWithinLimitI = document.getElementById('variation-within-limit-i').value;
            const variationPercentI = document.getElementById('variation-percent-i').value;
            const variationBeyondLimitI = document.getElementById('variation-beyond-limit-i').value;
            const variationBeyondPercentI = document.getElementById('variation-beyond-percent-i').value;
            const variationWithinLimitII = document.getElementById('variation-within-limit-ii').value;
            const variationPercentII = document.getElementById('variation-percent-ii').value;
            const variationBeyondLimitII = document.getElementById('variation-beyond-limit-ii').value;
            const variationBeyondPercentII = document.getElementById('variation-beyond-percent-ii').value;
            const variationWithinLimitIII = document.getElementById('variation-within-limit-iii').value;
            const variationPercentIII = document.getElementById('variation-percent-iii').value;
            const variationBeyondLimitIII = document.getElementById('variation-beyond-limit-iii').value;
            const variationBeyondPercentIII = document.getElementById('variation-beyond-percent-iii').value;

            // Generate the HTML with unique IDs for each cell
            const html = `<table style="border-collapse: collapse; width: 100%;" border="1" align="center">
<tbody>
<tr>
<td id="main-title" style="width: 100%; border-style: solid; border-color: #000000;" colspan="6" width="811" align="center"><b>Technical Approval of Post Award variation<br/>${formatText(mainTitle)}</b></td>
</tr>
<tr>
<td align="center" style="width: 2%" rowspan="10"><b>1</b></td>
<td style="width: 98%;" colspan="5" width="747"><b>Details of Purchase Order (PO)</b></td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(i) Name of Work</td>
<td id="work-name" style="width: 63%;" colspan="3">${formatText(workName)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(ii) Name of Project</td>
<td id="project-name" style="width: 63%;" colspan="3">${formatText(projectName)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(iii) PO No. & date</td>
<td id="po-details" style="width: 63%;" colspan="3">${formatText(poDetails)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(iv) PO Value (Original Awarded)</td>
<td id="po-value" style="width: 63%;" colspan="3">${formatText(poValue)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(v) Name of Agency/ Contractor</td>
<td id="contractor" style="width: 35%" colspan="3">${formatText(contractor)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(vi) Date of Start (Scheduled)</td>
<td id="start-date" style="width: 63%;" colspan="3">${formatText(startDate)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(vii) Date of completion (Scheduled/ Actual)</td>
<td id="completion-date" style="width: 63%;" colspan="3">${formatText(completionDate)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(viii) Location of processing of award</td>
<td id="location" style="width: 63%;" colspan="3">${formatText(location)}</td>
</tr>
<tr>
<td style="width: 35%" colspan="2">(ix) Mode of Tendering</td>
<td id="tendering-mode" style="width: 63%;" colspan="3">${formatText(tenderingMode)}</td>
</tr>
<tr>
<td align="center" style="width: 2%"><b>2</b></td>
<td style="width: 35%;" colspan="2"><b>Details of subsequent Amendment (if any) ; including Time extension</b></td>
<td id="amendment-details" style="width: 63%" colspan="3">${formatText(amendmentDetails)}</td>
</tr>
<tr>
<td align="center" style="width: 2%"><b>3</b></td>
<td style="width: 35%;" colspan="2"><b>Type for TA</b></td>
<td id="ta-type" style="width: 63%" colspan="3">${formatText(taType)}</td>
</tr>
<tr>
<td align="center" style="width: 2%"><b>4</b></td>
<td style="width: 35%;" colspan="2"><b>Relevant Contract provision w.r.t. Deviation</b></td>
<td id="contract-provision" style="width: 63%" colspan="3" width="246">${formatText(contractProvision)}</td>
</tr>
<tr>
<td align="center" style="width: 2%" rowspan="2"><b>5</b></td>
<td style="width: 98%" colspan="5"><b>Reason/ analysis of changes proposed Technical Proposal & recommendation</b></td>
</tr>
<tr>
<td id="reason-analysis" style="width: 98%;" colspan="5">${formatText(reasonAnalysis)}</td>
</tr>
<tr>
<td align="center" style="width: 2%" rowspan="2"><b>6</b></td>
<td style="width: 98%;" colspan="5"><b>Recommendation:</b></td>
</tr>
<tr>
<td id="recommendation" style="width: 98%;" colspan="5">${formatText(recommendation)}</td>
</tr>
<tr>
<td align="center" style="width: 2%" rowspan="8"><b>7</b></td>
<td style="width: 98%;" colspan="5">Details of Gross cumulative variations with respect to Initial Contract Price, on composite basis:</td>
</tr>
<tr>
<td style="width: 2%" align="center"><b>SN.</b></td>
<td style="width: 30%" align="center"><b>Description</b></td>
<td style="width: 30%" align="center"><b>DOP Clause Ref. No.</b></td>
<td style="width: 18%" align="center"><b>Total Amount of variation</b></td>
<td style="width: 18%" align="center"><b>% variation on composite basis</b></td>
</tr>
<tr>
<td style="width: 2%" align="center" rowspan="2">(i)</td>
<td style="width: 30%" rowspan="2">Gross cumulative variation on composite basis till last Amendment, if any</td>
<td style="width: 30%">w.r.t. within variation limit</td>
<td id="variation-within-limit-i" style="width: 18%" align="center">${formatText(variationWithinLimitI)}</td>
<td id="variation-percent-i" style="width: 18%" align="center">${formatText(variationPercentI)}</td>
</tr>
<tr>
<td style="width: 30%">w.r.t. beyond variation/ new/ substituted items</td>
<td id="variation-beyond-limit-i" style="width: 18%" align="center">${formatText(variationBeyondLimitI)}</td>
<td id="variation-beyond-percent-i" style="width: 18%" align="center">${formatText(variationBeyondPercentI)}</td>
</tr>
<tr>
<td style="width: 2%" align="center" rowspan="2">(ii)</td>
<td style="width: 30%" rowspan="2">Gross variation on composite basis - in Present Proposal</td>
<td style="width: 30%">w.r.t. within variation limit</td>
<td id="variation-within-limit-ii" style="width: 18%" align="center">${formatText(variationWithinLimitII)}</td>
<td id="variation-percent-ii" style="width: 18%" align="center">${formatText(variationPercentII)}</td>
</tr>
<tr>
<td style="width: 30%">w.r.t. beyond variation/ new/ substituted items</td>
<td id="variation-beyond-limit-ii" style="width: 18%" align="center">${formatText(variationBeyondLimitII)}</td>
<td id="variation-beyond-percent-ii" style="width: 18%" align="center">${formatText(variationBeyondPercentII)}</td>
</tr>
<tr>
<td style="width: 2%" align="center" rowspan="2">(iii)</td>
<td style="width: 30%" rowspan="2"><b>Gross cumulative variation on composite basis &ndash; including present Proposal</b></td>
<td style="width: 30%"><b>w.r.t. within variation limit</b></td>
<td id="variation-within-limit-iii" style="width: 18%" align="center">${formatText(variationWithinLimitIII)}</td>
<td id="variation-percent-iii" style="width: 18%" align="center">${formatText(variationPercentIII)}</td>
</tr>
<tr>
<td style="width: 30%"><b>w.r.t. beyond variation/ new/ substituted items</b></td>
<td id="variation-beyond-limit-iii" style="width: 18%" align="center">${formatText(variationBeyondLimitIII)}</td>
<td id="variation-beyond-percent-iii" style="width: 18%" align="center">${formatText(variationBeyondPercentIII)}</td>
</tr>
<tr>
<td align="center" style="width: 2%" rowspan="3"><b>8</b></td>
<td style="width: 98%;" colspan="5"><b>Approving authority for Technical Approval (Variations during post award execution of contracts)</b> - Gross cumulative variation on composite basis including present Proposal [refer 7 (iii) above]:</td>
</tr>
<tr>
<td style="width: 35%;" colspan="2">For items within the variation limit provided in the contract</td>
<td id="approving-within-limit" style="width: 63%;" colspan="3">${formatText(approvingWithinLimit)}</td>
</tr>
<tr>
<td style="width: 35%;" colspan="2">For items beyond the variation limit provided in the contract (including new items /substituted items)</td>
<td id="approving-beyond-limit" style="width: 63%;" colspan="3" align="left">${formatText(approvingBeyondLimit)}</td>
</tr>
</tbody>
</table>
<br/>`;
            
            document.getElementById('html-output').value = html;
            showNotification('HTML generated successfully!', 'success');
        }
        
        // Copy to clipboard
        function copyToClipboard() {
            const outputText = document.getElementById('html-output');
            outputText.select();
            document.execCommand('copy');
            
            showNotification('Copied to clipboard!', 'success');
        }
        
        // Download HTML
        function downloadHtml() {
            const htmlOutput = document.getElementById('html-output').value;
            if (!htmlOutput || htmlOutput === 'Your generated HTML will appear here...') {
                showNotification('Generate HTML first!', 'error');
                return;
            }
            
            const blob = new Blob([htmlOutput], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'technical_approval.html';
            document.body.appendChild(a);
            a.click();
            
            // Cleanup
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }
        
        // Reset form
        function resetForm() {
            if (confirm('Are you sure you want to reset all fields to default values?')) {
                document.getElementById('approval-form').reset();
                document.getElementById('html-output').value = 'Your generated HTML will appear here...';
                showNotification('Form reset to default values', 'success');
            }
        }
        
        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            
            // Reset classes
            notification.className = 'notification';
            
            if (type === 'error') {
                notification.classList.add('error');
            }
            
            // Show notification
            notification.classList.add('show');
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Initialize the form
        document.addEventListener('DOMContentLoaded', function() {
            // Set up tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(`${tabName}-tab`).classList.add('active');
                });
            });
        });
    </script>
</body>
</html>
